# Demo 3: 复杂排序性能对比

> JavaScript vs WebAssembly - 100 万数据排序性能测试

## 📖 简介

本演示对比 JavaScript 和 WebAssembly 在大规模数据排序中的性能差异。

## 🎯 功能特点

- **排序算法**：快速排序（Quicksort）、冒泡排序（Bubblesort）
- **测试数据**：随机生成的整数数组（可配置大小）
- **性能指标**：执行时间、排序速度（元素/秒）
- **数据验证**：自动验证排序结果的正确性

## 🔧 编译步骤

```bash
cd src/13-sorting
wat2wasm sort.wat -o sort.wasm
```

## 🌐 运行示例

1. 启动本地 HTTP 服务器：
   ```bash
   python3 -m http.server 8000
   ```

2. 在浏览器中打开：
   ```
   http://localhost:8000/13-sorting/
   ```

3. 配置测试参数：
   - 选择数据量（默认 10 万，最大 1000 万）
   - 选择排序算法（快速排序或冒泡排序）
   - 点击"开始性能测试"

## 📊 性能对比

### 测试结果示例

**10 万数据（快速排序）**：
- JavaScript: ~50-100 ms
- WebAssembly: ~20-40 ms
- **性能提升**: 2-3x

**100 万数据（快速排序）**：
- JavaScript: ~500-1000 ms
- WebAssembly: ~200-400 ms
- **性能提升**: 2-3x

**1000 万数据（快速排序）**：
- JavaScript: ~5000-10000 ms
- WebAssembly: ~2000-4000 ms
- **性能提升**: 2-3x

### 性能分析

1. **WebAssembly 优势**：
   - 直接内存操作，无数组操作开销
   - 编译优化，执行效率高
   - 递归调用性能好

2. **JavaScript 特点**：
   - 数组操作有额外开销
   - 动态类型检查
   - 递归调用性能较差

## 📁 文件说明

- `sort.wat` - WebAssembly 文本格式源代码
- `sort.wasm` - 编译后的二进制文件
- `index.html` - 演示页面
- `README.md` - 本说明文档

## 🔍 排序算法说明

### 快速排序（Quicksort）

**算法复杂度**：
- 平均时间复杂度：O(n log n)
- 最坏时间复杂度：O(n²)
- 空间复杂度：O(log n)

**算法步骤**：
1. 选择 pivot（中间元素）
2. 分区：将小于 pivot 的元素放在左边，大于 pivot 的元素放在右边
3. 递归排序左右两部分

**WebAssembly 实现**：
- 使用递归实现
- 直接内存操作，无数组复制开销
- 原地排序，节省内存

### 冒泡排序（Bubblesort）

**算法复杂度**：
- 时间复杂度：O(n²)
- 空间复杂度：O(1)

**算法步骤**：
1. 比较相邻元素，如果顺序错误则交换
2. 重复直到没有需要交换的元素

**注意**：冒泡排序性能较差，仅用于对比演示。

## 💡 使用场景

1. **大数据处理**：需要排序大量数据的应用
2. **实时排序**：需要快速响应的排序操作
3. **性能优化**：在排序密集型应用中提升性能
4. **数据分析**：数据分析和统计应用

## 🚀 扩展建议

1. **更多排序算法**：
   - 归并排序（Merge Sort）
   - 堆排序（Heap Sort）
   - 基数排序（Radix Sort）

2. **并行排序**：
   - 使用 Web Workers
   - 分块并行排序

3. **SIMD 优化**：
   - 使用 SIMD 指令并行比较
   - 进一步提升性能

4. **混合排序**：
   - 小数组使用插入排序
   - 大数组使用快速排序

## ⚠️ 注意事项

1. **内存限制**：
   - 大数据量需要足够的内存
   - WebAssembly 内存会自动增长

2. **执行时间**：
   - 大数据量排序可能需要较长时间
   - 建议从较小的数据量开始测试

3. **浏览器性能**：
   - 不同浏览器的性能可能有差异
   - 建议在 Chrome 或 Firefox 中测试

---

**创建日期**：2025年12月9日  
**示例版本**：v1.0

